apiVersion: apps/v1
kind: deployment
metadata:
 name:
spec:
 replicas: 1
 selector:
  matchLabels:
   app: mssql
 template:
  metadata:
   labels:
    app: mssql
  spec:
   containers:
    - name: mssql
      image: mcr.microsoft.com/mssql/server:2018-latest
      ports:
       - containerPort: 1433
      env:
       - name: MSSQL_PID
         value: "Express"
       - name: ACCEPT_EULA
         value: "Y"
       - name: SA_PASSWORD
         valueForm:
          secretkeyRef:
           name: mssql
           key: SA_PASSWORD
      volumeMounts:
       - mountPath: /var/opt/mssql/data
         name: mssqldb
   volume:
    - name: mssql
      persistentVolumeClaim:
       claimName: mssql-claim
---
apiVersion: v1
kind: Service
metadata:
  name: mssql-clusterip-srv
spec:
  type: ClusterIP
  selector:
    app: mssql
  ports:
  - name: mssql
    protocol: TCP
    port: 1433
    targetPort: 1433
          
